{% extends "base.html" %}

{% block title %}Archived Students - Teacher{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="page-header">
        <h1><i class="fas fa-box-archive"></i> Archived Students</h1>
        <p>Students who have stopped studying or were permanently deleted.</p>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Student</th>
                            <th>Student ID</th>
                            <th>Year Level</th>
                            <th>Reason</th>
                            <th>Status</th>
                            <th class="text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for s in students %}
                        <tr>
                            <td>
                                <div class="list-item">
                                    <div class="list-avatar">
                                        {% if s.avatar %}
                                        <img src="/{{ s.avatar }}" alt="{{ s.first_name }} {{ s.last_name }}" class="avatar-circle">
                                        {% else %}
                                        <span class="avatar-circle">{{ (s.first_name[:1] ~ s.last_name[:1])|upper }}</span>
                                        {% endif %}
                                    </div>
                                    <div class="list-info">
                                        <h6>{{ s.first_name }} {{ s.last_name }}</h6>
                                        <p>Grade {{ s.year_level }}</p>
                                    </div>
                                </div>
                            </td>
                            <td>{{ s.student_id }}</td>
                            <td>Grade {{ s.year_level }}</td>
                            <td>{{ s.archive_reason or 'â€”' }}</td>
                            <td>
                                {% if s.permanently_deleted %}
                                <span class="badge badge-danger">Permanently Deleted</span>
                                {% else %}
                                <span class="badge badge-warning">Archived</span>
                                {% endif %}
                            </td>
                            <td class="text-right">
                                <form method="POST" action="{{ url_for('teacher_restore_student', student_id=s.id) }}" style="display:inline;" onsubmit="return confirm('Restore this student to active list?');">
                                    <button type="submit" class="btn btn-xs btn-secondary">Restore</button>
                                </form>
                                <form method="POST" action="{{ url_for('teacher_hard_delete_student', student_id=s.id) }}" style="display:inline;" onsubmit="return confirm('Permanently remove this student record? This cannot be undone.');">
                                    <button type="submit" class="btn btn-xs btn-danger">Delete</button>
                                </form>
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="5" class="text-center">No archived students found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
